---
import { useTranslations, type Language } from '../../i18n';
import { videos } from '../../data/videos';

interface Props {
  lang: Language;
}

const { lang } = Astro.props;
const t = useTranslations(lang);
const base = import.meta.env.BASE_URL;

// Get videos with base URL prepended
const displayVideos = videos.map(video => ({
  ...video,
  src: `${base}${video.src.replace(/^\//, '')}`
}));
---

<section class="section-padding bg-white">
  <div class="container-custom">
    <!-- Section Header -->
    <div class="text-center max-w-2xl mx-auto mb-12 animate-on-scroll">
      <span class="text-gold-500 font-semibold text-sm tracking-wider uppercase mb-2 block">
        {t('videos.subtitle')}
      </span>
      <h2 class="text-navy-600 mb-4">{t('videos.title')}</h2>
    </div>

    <!-- Video Grid -->
    <div class="grid grid-cols-1 md:grid-cols-2 gap-8 stagger-children">
      {displayVideos.map((video) => (
        <div class="relative rounded-2xl overflow-hidden shadow-lg bg-gray-900 animate-on-scroll">
          <video
            class="w-full aspect-video"
            controls
            preload="metadata"
            poster={video.thumbnail}
          >
            <source src={video.src} type="video/mp4" />
            Your browser does not support the video tag.
          </video>
          <!-- Video Title Overlay -->
          <div class="absolute bottom-0 left-0 right-0 bg-gradient-to-t from-navy-900/90 to-transparent p-4 pointer-events-none">
            <span class="inline-block px-3 py-1 bg-gold-500/90 text-white text-xs font-medium rounded-full capitalize">
              {video.category}
            </span>
          </div>
        </div>
      ))}
    </div>
  </div>
</section>
